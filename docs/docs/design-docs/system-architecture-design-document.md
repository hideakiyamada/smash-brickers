---
sidebar_position: 4
---

# システムアーキテクチャ設計書

## 1. システム全体像

- **ゲームタイトル**：オンライン対戦型ブロック崩し
- **プラットフォーム**：PC（Unreal Engine 5対応）
- **開発言語**：主にブループリント、必要に応じてC++
- **ネットワーク**：オンライン対戦対応（最大2～4人、1vs1 or 2vs2など）

## 2. 主要機能

- **オンライン対戦**
  - ぷよぷよ風に画面が2分割され、各プレイヤーが自身のエリアでブロック崩しを行う
  - 最大2人（将来的に4人まで拡張可能）
  - マッチメイキング（フレンド対戦・ランダムマッチ）
  - 1人プレイも可能（シングルプレイ）
- **勝敗条件**
  - 全てのブロックを先に壊したプレイヤーが勝利
  - ボールが落ちた場合、一定時間のペナルティ後に再開
- **パワーアップ・特殊ブロック**
  - パワーアップアイテムや特殊ブロックを配置し、ゲーム性を向上
- **ランキング・スコア管理**
  - ゲーム終了時にスコアをREST API経由でサーバーに送信
  - ランキング取得・表示機能
- **多言語化**
  - 日本語・英語対応
- **AI対戦**（追加機能）
  - コンピュータとの対戦も可能（AI実装）

## 3. システム構成

### 3.1 クライアント側

- **ゲームロジック**
  - ブロック崩しコアロジック（ブロック、ボール、ラケット、コリジョン等）
  - パワーアップ・特殊ブロック処理
- **UI/UX**
  - 2分割画面による対戦UI
  - マッチメイキングUI（フレンド対戦・ランダムマッチ）
  - ランキング表示UI
  - 多言語対応UI
- **ネットワーク通信**
  - オンライン対戦処理（Unreal Engineのネットワーク機能利用）
  - モーションやイベント同期（Gameplay Ability System等で自動化）[5]
- **スコア送信**
  - ゲーム終了時にREST APIでサーバーにスコア送信

### 3.2 サーバー側

- **マッチメイキングサーバー**
  - プレイヤー同士のマッチング処理
- **ゲームサーバー**
  - オンライン対戦時のゲームロジック同期
  - イベント通知（ブロック破壊、パワーアップ取得等）
- **ランキングサーバー**
  - スコア受信・保存
  - ランキングデータの取得・返却

## 4. ネットワーク設計

- **通信方式**：クライアント・サーバーモデル[5]
- **同期処理**
  - ゲームロジック（ブロック状態、ボール位置等）はサーバーで管理
  - クライアントは入力情報をサーバーに送信し、サーバーから最新状態を受け取る
  - モーションやイベントはサーバーからマルチキャストで同期[5]
- **マッチメイキング**
  - フレンド対戦・ランダムマッチに対応

## 5. データ設計

- **プレイヤーデータ**
  - プレイヤーID
  - ニックネーム
  - スコア
  - ランキング情報
- **ゲームデータ**
  - ブロック配置
  - ボール位置
  - パワーアップ状態
  - 勝敗情報

## 6. 拡張性・将来性

- **プレイヤー人数拡張**：最大4人まで対応可能な設計
- **AI対戦**：必要に応じてAIを追加
- **多言語化**：日本語・英語以外にも対応可能な設計

## 7. 課題・検討事項

- **スコア算出方法**：ブロック破壊数やタイムアタック等、スコア算出ロジックを検討
- **AI対戦の実装**：必要に応じてAIロジックを追加
- **モーション同期の最適化**：Gameplay Ability System等を活用してラグを低減[5]

---

## 補足：設計のポイント

- **クリーンアーキテクチャの採用**：ロジックとUI、ネットワーク層を明確に分離し、拡張性を確保[1]
- **Unreal Engineのネットワーク機能活用**：ブループリントでもマルチプレイヤー化が容易[4][5]
- **多言語対応**：UIテキストを外部ファイル化し、言語切り替え機能を実装

---

この設計書をもとに、各機能の詳細設計や実装方針を決定していきます。

Citations:
[1] https://qiita.com/shiracamus/items/54b7bf1af018ce829335
[2] https://note.com/inrash/n/n2f4cd113668e
[3] https://note.com/lana50026/n/n36a7a911de72
[4] https://www.docswell.com/s/alwei/KRW71Z-2022-05-12-152255
[5] https://note.com/inrash/n/n0e121cd3168b
[6] https://www.bit.urayama.ac.jp/data/4_parents/1_syllabus/2020/1_sys.pdf
[7] https://www.cesa.or.jp/uploads/2008/per/report.pdf
[8] https://www.dcaj.or.jp/project/report/pdf/2008/dc_08_03.pdf
[9] https://ja.wikipedia.org/wiki/%E3%82%A2%E3%83%BC%E3%82%B1%E3%83%BC%E3%83%89%E3%82%B2%E3%83%BC%E3%83%A0
[10] https://ja.wikipedia.org/wiki/%E3%82%B2%E3%83%BC%E3%83%A0%E6%A9%9F

---
Answer from Perplexity: pplx.ai/share
